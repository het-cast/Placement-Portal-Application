@using PlacementPortal.BLL.Constants
@using PlacementPortal.BLL.Enums;
@using PlacementPortal.DAL.ViewModels
@model PlacementPortal.DAL.ViewModels.PaginationDTO<CompanyJobListingDTO>;
@{
    string UserRole = Context.Request.Cookies["Role"] ?? RoleEnum.Student.ToString();
}

@if (Model.Items?.Count <= 0 || Model.Items == null)
{
    <div class="d-flex justify-content-center align-items-center fs-3 fw-bold"
        style="background-color: #eae6f9; color: #5f4dbf;">
        <p>@GeneralConst.NoJobListingsFound</p>
    </div>
}

else
{
    @foreach (var listing in Model.Items)
    {
        <div class="job-listing">
            <div class="job-title">
                <i class="fas fa-briefcase"></i>
                <span>@listing.JobDomain</span> - <span>@listing.JobProfie</span>
            </div>
            <div class="job-detail">
                <i class="fas fa-rupee-sign"></i>
                <strong>Salary:</strong> ₹@listing.MinimumSalary - ₹@listing.MaximumSalary LPA
            </div>
            <div class="job-detail">
                <i class="fas fa-graduation-cap"></i>
                <strong>CGPA Required:</strong> @listing.MinCgpaRequired
            </div>
            <div class="job-detail">
                <i class="fas fa-exclamation-triangle"></i>
                <strong>Backlogs Allowed:</strong> @listing.MaxBacklogsAllowed
            </div>

            <div class="job-detail">
                <i class="fas fa-calendar-alt"></i>
                <strong>Apply Window:</strong> @listing.ApplicationStartDate.ToString() -
                @listing.ApplicationEndDate.ToString()
            </div>
            @if (UserRole == RoleEnum.Student.ToString())
            {
                <button class="btn-apply job-listing-apply-btn" data-companyid="@listing.CompanyId"
                    data-joblistingid="@listing.JobListingId">
                    <i class="fas fa-paper-plane"></i>
                    Apply Now
                </button>
            }
        </div>
    }

    <div class="pagination d-flex flex-column flex-md-row justify-content-center gap-2 pb-2">
        <div class="d-flex Pages justify-content-center align-items-center">
            <button id="previousJobListing" @(Model.CurrentPage > 1 ? "" : "disabled") type="button"
                style="background-color: rgba(102, 126, 234, 0.1);"
                class="btn btn-outline-secondary arrows d-flex justify-content-center align-items-center px-3 py-2 mx-2">
                <i class="fa-solid fa-angle-left" style="color: #5473ff;"></i>
            </button>
            <div class="d-flex justify-content-center align-items-center gap-3 mx-5">
                <p class="m-0">Items Per Page:</p>
                <div class="">
                    <select id="pageSizeJobListing" class="px-2 border border-1 border-black p-1"
                        style="border-radius: 5px; background-color: rgba(102, 126, 234, 0.1);" asp-for="PageSize">
                        <option value="3" selected="@(Model.PageSize == 3)">3</option>
                        <option value="5" selected="@(Model.PageSize == 5)">5</option>
                        <option value="10" selected="@(Model.PageSize == 10)">10</option>
                        <option value="15" selected="@(Model.PageSize == 15)">15</option>
                        <option value="@Model.TotalRecords" selected="@(Model.PageSize == Model.TotalRecords)">All</option>
                    </select>
                </div>
            </div>
            <button id="nextJobListing" @(Model.CurrentPage < Model.TotalPages ? "" : "disabled") type="button"
                style="background-color: rgba(102, 126, 234, 0.1);"
                class="btn btn-outline-secondary arrows d-flex justify-content-center align-items-center px-3 py-2 me-1">
                <i class="fa-solid fa-angle-right" style="color: #5473ff;"></i>
            </button>
        </div>

    </div>
    <div class="w-100 d-flex justify-content-center mt-3">
        <p class="m-0 mx-1">Showing @Model.StartIndex-
            @(Model.EndIndex) of @Model.TotalRecords
        </p>
    </div>
}
